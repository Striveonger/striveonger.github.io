(window.webpackJsonp=window.webpackJsonp||[]).push([[132],{659:function(t,s,a){"use strict";a.r(s);var e=a(4),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("ElasticSearch 数据源设计(基于7.x版本)")]),t._v(" "),a("h3",{attrs:{id:"elasticsearch-数据源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-数据源"}},[t._v("#")]),t._v(" ElasticSearch 数据源")]),t._v(" "),a("p",[a("span",{staticStyle:{"font-size":"13px",float:"right"}},[t._v("基于7.2版本开发, 建议6.x及以上版本使用")])]),t._v(" "),a("h4",{attrs:{id:"创建数据源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建数据源"}},[t._v("#")]),t._v(" 创建数据源")]),t._v(" "),a("p",[a("span",{staticStyle:{"font-size":"11px","font-weight":"bold"}},[t._v("        所需参数:")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("所需信息名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("是否必填")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("数据源名称")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("创建的数据源名")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("服务器地址")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用于访问ElasticSearch("),a("span",{staticStyle:{"font-size":"13px"}},[t._v("IP或域名皆可, 需公网可访问")]),t._v(")")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("端口号")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用于访问ElasticSearch("),a("span",{staticStyle:{"font-size":"13px"}},[t._v("需公网可访问")]),t._v(")")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("验证用户")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用于标识访问ElasticSearch时, 是否需要验证用户信息")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("用户名")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("当需要验证用户信息时, 必填")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("密码")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("当需要验证用户信息时, 必填")])])])]),t._v(" "),a("p",[a("span",{staticStyle:{"font-size":"11px","font-weight":"bold"}},[t._v("例1:")])]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"datasourceName"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ES_Test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"host"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"192.168.10.13"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"port"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9400"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"isAuth"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"false"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[a("span",{staticStyle:{"font-size":"11px","font-weight":"bold"}},[t._v("例2:")])]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"datasourceName"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ES_Test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"host"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"192.168.10.13"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"port"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9400"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"isAuth"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"username"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"password"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("blockquote",[a("p",[t._v("验证失败信息尚未做处理(比如: 连接失败或用户名密码错误未做分类)")])]),t._v(" "),a("h4",{attrs:{id:"创建数据表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建数据表"}},[t._v("#")]),t._v(" 创建数据表")]),t._v(" "),a("p",[a("span",{staticStyle:{"font-size":"11px","font-weight":"bold"}},[t._v("所需参数:")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("所需信息名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("是否必填")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("数据源ID")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("所属的数据源")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("表名")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("创建的表名")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("索引(index)")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("ElasticSearch的index名")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("类型(type)")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("指定index的type，默认是_doc")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("精确匹配(exactMatch)")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是否精确匹配index")])])])]),t._v(" "),a("p",[a("span",{staticStyle:{"font-size":"11px","font-weight":"bold"}},[t._v("例1:")])]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"datasourceId"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("469")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"tablename"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ES_Table"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_doc"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"exactMatch"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[a("span",{staticStyle:{"font-size":"11px","font-weight":"bold"}},[t._v("例2:")])]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"datasourceId"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("469")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"tablename"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ES_Table"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"index"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user,user_info"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_doc"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"exactMatch"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("blockquote",[a("ol",[a("li",[t._v("建议"),a("code",[t._v("index")]),t._v("与"),a("code",[t._v("type")]),t._v("为一对一关系(这也是ElasticSearch官方的态度).")]),t._v(" "),a("li",[a("code",[t._v("index")]),t._v(" 与 "),a("code",[t._v("type")]),t._v(" 的录入与展示方式:")])]),t._v(" "),a("ul",[a("li",[t._v("后台可以获得所有"),a("code",[t._v("index")]),t._v(", 但无法活得 "),a("code",[t._v("type")]),t._v("信息.")]),t._v(" "),a("li",[a("code",[t._v("index")]),t._v(" 可能会比较多, 建议分页展示.")]),t._v(" "),a("li",[a("code",[t._v("type")]),t._v(" 由于后台无法获取到, 所以要用户自己输入. 用户不输入, 默认为"),a("code",[t._v("_doc")])])]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("当模糊检索"),a("code",[t._v("index")]),t._v("信息时, 索引名既可以写全名用"),a("code",[t._v(",")]),t._v("隔开也可以用通配符"),a("code",[t._v("*")]),t._v(" (eg: "),a("code",[t._v("use*")]),t._v(", "),a("code",[t._v("*se*")]),t._v(")")]),t._v(" "),a("li",[t._v("从ElasticSearch的语法上是支持只加一个"),a("code",[t._v("*")]),t._v("的(检索所有"),a("code",[t._v("index")]),t._v("), 但我们是不允许这样的(后台会做限制).")]),t._v(" "),a("li",[t._v("若模糊检索"),a("code",[t._v("index")]),t._v(", 表达式匹配到的表结构要求一致.")]),t._v(" "),a("li",[t._v("ElasticSearch 数据源暂时不支持 "),a("code",[t._v("合表")])])])]),t._v(" "),a("h4",{attrs:{id:"预览数据表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预览数据表"}},[t._v("#")]),t._v(" 预览数据表")]),t._v(" "),a("blockquote",[a("p",[t._v("入参与其他数据源一致, 这里就不一一罗列了.")])]),t._v(" "),a("p",[a("strong",[t._v("需要注意:")])]),t._v(" "),a("ul",[a("li",[t._v("ElasticSearch 不支持 "),a("code",[t._v("表达式过滤")])]),t._v(" "),a("li",[t._v("在进行精确查询时, 字符串类型数据只支持"),a("code",[t._v("keyword")]),t._v("类型数据")]),t._v(" "),a("li",[t._v("ElasticSearch 数据源暂时不支持 "),a("code",[t._v("添加字段")])])]),t._v(" "),a("h4",{attrs:{id:"预览图表-聚合数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预览图表-聚合数据"}},[t._v("#")]),t._v(" 预览图表(聚合数据)")]),t._v(" "),a("blockquote",[a("p",[t._v("入参与其他数据源一致, 这里就不一一罗列了.")])]),t._v(" "),a("p",[a("strong",[t._v("需要注意:")])]),t._v(" "),a("ul",[a("li",[t._v("时间做维度时, 暂时不支持"),a("code",[t._v("按周")]),t._v(", "),a("code",[t._v("按年周")]),t._v(" 聚合")])]),t._v(" "),a("blockquote",[a("p",[a("span",{staticStyle:{"font-size":"23px","font-weight":"bold",color:"red"}},[t._v("注: 上述所需参数只做为示例, 具体传参形式, 后期与前端一起商定.")])]),t._v(" "),a("p",[a("span",{staticStyle:{"font-size":"13px"}},[t._v("目前以精确匹配index做的开发, 模糊匹配尚不支持. ")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);